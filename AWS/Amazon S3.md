
![1759366919653](image/AmazonS3/1759366919653.png)

# Amazon S3

---

## 1. **What is Amazon S3?**

Amazon Simple Storage Service (S3) is AWSâ€™s  **object storage service** .

* Stores **objects** (files, images, backups, logs, etc.) in  **buckets** .
* Infinite storage, 11 nines of durability (99.999999999%).
* Scales automatically.
* Pay for what you use (storage + requests + data transfer).

---

## 2. **Core S3 Concepts**

* **Buckets** â†’ containers for objects.
* **Objects** â†’ files/data (max size: 5TB).
* **Keys** â†’ unique identifier for each object (`bucket-name/key`).
* **Regions** â†’ buckets live in a specific AWS region.

---

## 3. **S3 Versioning**

* Allows keeping **multiple versions** of the same object.
* Protects against accidental deletion or overwrite.

ðŸ“Œ  **How it works** :

* Once enabled, every time you upload a new version of an object, S3 assigns a  **version ID** .
* Even if you delete the object, S3 keeps a "delete marker" â€” older versions are still retrievable.

ðŸ“Œ  **Use Cases** :

* Protect against accidental deletes.
* Maintain history of documents/files.

ðŸ“Œ  **Interview Tip** :

Versioning cannot be **disabled** once enabled â€” only  **suspended** .

---

## 4. **Lifecycle Policies**

* Automates object **transition** between storage classes and  **expiration** .
* Rules are set at bucket or prefix level.

ðŸ“Œ  **Storage Classes** :

* S3 Standard â†’ frequently accessed data.
* S3 Standard-IA (Infrequent Access).
* S3 One Zone-IA â†’ cheaper, but single AZ.
* S3 Glacier / Glacier Deep Archive â†’ archival storage.
* S3 Intelligent-Tiering â†’ automatically moves data between tiers.

ðŸ“Œ  **Example Lifecycle Policy** :

* After 30 days â†’ move to Standard-IA.
* After 90 days â†’ move to Glacier.
* After 365 days â†’ delete permanently.

ðŸ“Œ  **Use Cases** :

* Cost optimization for logs, backups, infrequently used data.

---

## 5. **S3 Encryption**

S3 supports **server-side** and **client-side** encryption.

### a) **Server-Side Encryption (SSE)**

* **SSE-S3** â†’ AWS manages keys.
* **SSE-KMS** â†’ AWS KMS manages keys, with more control/audit.
* **SSE-C** â†’ Customer manages keys.

### b) **Client-Side Encryption**

* You encrypt data before uploading.

ðŸ“Œ  **Default Encryption** : You can enforce all new objects in a bucket to be encrypted automatically.

ðŸ“Œ  **Interview Tip** :

Most enterprises use **SSE-KMS** because it integrates with IAM permissions & CloudTrail auditing.

---

## 6. **Presigned URLs**

* A **temporary signed URL** that allows access to a private object in S3 without making the bucket public.
* Generated by an IAM user/role with permission.
* Can allow **GET (download)** or  **PUT (upload)** .
* Expiry time configurable (default max: 7 days with AWS SDKs).

ðŸ“Œ  **Use Cases** :

* Sharing a private file temporarily.
* Allowing clients to upload files directly to S3 without going through your backend.

ðŸ“Œ  **Example (Python boto3)** :

```python
import boto3

s3 = boto3.client('s3')

url = s3.generate_presigned_url(
    'get_object',
    Params={'Bucket': 'my-bucket', 'Key': 'report.pdf'},
    ExpiresIn=3600  # 1 hour
)

print("Presigned URL:", url)
```

---

## 7. **Security Best Practices**

* Block Public Access (default).
* Use **bucket policies** and **IAM roles** for fine-grained permissions.
* Use **SSE-KMS** for encryption.
* Enable **MFA Delete** for versioned buckets (extra protection).
* Use **Access Logs** + **CloudTrail** for auditing.

---

## 8. **S3 Interview-Level Scenarios**

1. **Q: How do you protect data from accidental deletion?**

   â†’ Enable **versioning** +  **MFA delete** .
2. **Q: How do you reduce costs for old logs?**

   â†’ Use **lifecycle policies** to transition to Glacier.
3. **Q: How do you securely share a private file?**

   â†’ Generate a  **presigned URL** .
4. **Q: Which encryption method gives most control?**

   â†’  **SSE-KMS** , because you can audit and control access to KMS keys.

---

## 9. **Mermaid Diagram (S3 Lifecycle & Access)**

```mermaid
flowchart TD
    A[User] -->|Upload File| B[S3 Bucket]
    B -->|Versioning| C[Multiple Versions Stored]
    B -->|Lifecycle Policy| D[S3 Glacier / Delete]
    B -->|Encryption| E[SSE-S3 / SSE-KMS / SSE-C]
    B -->|Presigned URL| F[Temporary Access for Clients]

```

---
